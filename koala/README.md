# Koala
实现通用的文件下载管理器,同时要具有很好的稳定性、可扩展性、可维护性,力求简单易用。

### 存在的问题
- 目前离线下载由于和数据库及状态耦合太深，很难抽取出来适应新的车机下载要求
- 耦合的问题：
1. 对下载状态的管理松散，到处都是对下载状态的处理
2. 对下载状态的保存使用数据库，但是没有对状态持久化进行必要的隔离
3. 万能的getLastFragment()
4. 业务逻辑与下载任务耦合太深


### 需要实现的功能

- 必须支持断点续传
- 支持并行和串行两种下载方式
- 支持大文件下载(超过2G以上),需要考虑OOM问题
- 使用service作为载体?单独进程?
- 支持自定义最大下载线程数
- 支持自定义剩余空间检测
- 回调函数避免UI线程掉帧问题
- 支持全局的下载生命周期监听
- 底层下载代码使用CC?OkHttp?
- 支持插入自定义状态和活动(比如插入解压缩、MD5校验等)
- 其他问题:版本兼容(v6升级等)(两级配置策略?)、下载有更新、下载城市的顺序问题(现离线代码中在下载前有对下载城市进行排序的逻辑)
- 支持指定网络环境下载(如只允许wifi环境下载,在切换环境时暂停下载操作)